{"version":3,"sources":["openseadragon-justified-collection.js"],"names":["$","version","major","Error","World","prototype","arrange","options","this","justifiedCollectionInstance","viewer","justifiedCollection","extend","immediately","layout","DEFAULT_SETTINGS","collectionLayout","rows","collectionRows","columns","tileSize","collectionTileSize","tileMargin","ImageRow","Row","i","_items","length","item","addTileSource","draw","world","ready","images","height","resizePercentage","totalWidth","firstRow","rowWidth","line","called","x","map","image","setHeight","setPosition","y","tileSourceBounds","getBounds","width","tileSource","isReady","ratio","Math","round","push","OpenSeadragon"],"mappings":"CAAA,SAAAA,GACA,YAEA,KAAAA,EAAAC,SAAAD,EAAAC,QAAAC,MAAA,EACA,KAAA,IAAAC,OAAA,kFAGAH,GAAAI,MAAAC,UAAAC,QAAA,SAAAC,GAMA,MALAC,MAAAC,8BAAAF,IACAA,EAAAA,MACAA,EAAAG,OAAAF,KACAA,KAAAC,4BAAA,GAAAT,GAAAW,oBAAAJ,IAEAC,KAAAC,6BAQAT,EAAAW,oBAAA,SAAAJ,GACAP,EAAAY,QAAA,EAAAJ,MACAK,YAAAN,EAAAM,cAAA,EACAC,OAAAP,EAAAO,QAAAd,EAAAe,iBAAAC,iBACAC,KAAAV,EAAAU,MAAAjB,EAAAe,iBAAAG,eACAC,QAAAZ,EAAAY,SAAA,EACAC,SAAAb,EAAAa,UAAApB,EAAAe,iBAAAM,mBACAC,WAAAf,EAAAe,YAAA,IACAf,EAIA,KAAA,GAFAgB,GAAA,GAAAvB,GAAAwB,IAAAhB,MAEAiB,EAAA,EAAAA,EAAAjB,KAAAE,OAAAgB,OAAAC,OAAAF,IAAA,CACA,GAAAG,GAAApB,KAAAE,OAAAgB,OAAAD,EAGAF,GAAAM,cAAAD,GAIAL,EAAAO,QAIA9B,EAAAwB,IAAA,SAAAO,GACA/B,EAAAY,QAAA,EAAAJ,KAAAuB,GAEAvB,KAAAwB,OAAA,EACAxB,KAAAyB,UACAzB,KAAA0B,OAAA,EACA1B,KAAA2B,iBAAA,EACA3B,KAAA4B,WAAA,EACA5B,KAAA6B,UAAA,EACA7B,KAAA8B,SAAA,EACA9B,KAAA+B,KAAA,EACA/B,KAAAgC,OAAA,EAGAhC,KAAAsB,KAAA,WAEA,GAAAW,GAAA,CACAjC,MAAAyB,OAAAS,IAAA,SAAAC,GACAA,EAAAC,UAAApC,KAAA0B,QAAA,GACAS,EAAAE,aAAAJ,EAAAA,EAAAK,EAAAtC,KAAA+B,MACA,IAAAQ,GAAAJ,EAAAK,WACAP,GAAAA,EAAAM,EAAAE,MAAAzC,KAAAc,WAAAd,KAAA0B,QACA1B,MAGAA,KAAAwB,OAAA,EACAxB,KAAA+B,MAAA/B,KAAA0B,OAAA1B,KAAAc,WACAd,KAAAyB,UAEAzB,KAAA8B,SAAA,GAGA9B,KAAAqB,cAAA,SAAAqB,GAEA,GADA1C,KAAAgC,SACAhC,KAAA2C,UACA,KAAA,oCAIAD,GAAAN,UAAA,GAAA,EAEA,IAAAG,GAAAG,EAAAF,WASA,IARAE,EAAAE,MAAAC,KAAAC,MAAAP,EAAAE,MAAAF,EAAAb,OAAA,KAAA,IACAgB,EAAAD,MAAAF,EAAAE,MAEAzC,KAAAyB,OAAAsB,KAAAL,GAEA1C,KAAA8B,SAAA9B,KAAA8B,SAAAY,EAAA,MAAA1C,KAAAc,WAGAd,KAAA6B,YAAA,GAAA7B,KAAAyB,OAAAN,SAAAnB,KAAAW,QAKA,MAJAX,MAAA4B,WAAA5B,KAAA8B,SACA9B,KAAA6B,UAAA,EACA7B,KAAAwB,OAAA,MACAxB,MAAAsB,MAIA,IAAAtB,KAAA6B,YAAA,GAAA7B,KAAA8B,UAAA9B,KAAA4B,WAAA,CACA,GAAAD,GAAA3B,KAAA4B,WAAA5B,KAAA8B,QACA9B,MAAA0B,OAAAC,EACA3B,KAAAwB,OAAA,EACAxB,KAAAsB,SAIAtB,KAAA2C,QAAA,WACA,MAAA3C,MAAAwB,SAIAwB","file":"openseadragon-justified-collection.min.js","sourcesContent":["(function ($) {\n    'use strict';\n\n    if (!$.version || $.version.major < 2) {\n        throw new Error('This version of OpenSeadragonImagefilters requires OpenSeadragon version 2.0.0+');\n    }\n\n    $.World.prototype.arrange = function (options) {\n        if (!this.justifiedCollectionInstance || options) {\n            options = options || {};\n            options.viewer = this;\n            this.justifiedCollectionInstance = new $.justifiedCollection(options);\n        }\n        return this.justifiedCollectionInstance;\n    };\n\n    /**\n     * @class justifiedCollection\n     * @classdesc Provides functionality for arranging images in a justified grid layout\n     * @param {Object} options\n     */\n    $.justifiedCollection = function (options) {\n        $.extend(true, this, {\n            immediately: options.immediately || false,\n            layout: options.layout || $.DEFAULT_SETTINGS.collectionLayout,\n            rows: options.rows || $.DEFAULT_SETTINGS.collectionRows,\n            columns: options.columns || 8,\n            tileSize: options.tileSize || $.DEFAULT_SETTINGS.collectionTileSize,\n            tileMargin: options.tileMargin || 0.1\n        }, options);\n\n        var ImageRow = new $.Row(this);\n\n        for (var i = 0; i < this.viewer._items.length; i++) {\n            var item = this.viewer._items[i];\n\n            //imagerow will set positions of items\n            ImageRow.addTileSource(item);\n        }\n\n        //draw remaining\n        ImageRow.draw();\n        \n    };\n\n    $.Row = function (world){\n        $.extend(true, this, world);\n\n        this.ready = false;\n        this.images = []; //temp array of images needed for row buffering\n        this.height = 1; //changed based on ratio of row based on first row\n        this.resizePercentage = 1;\n        this.totalWidth = 0; //after first row we know the total width\n        this.firstRow = true; //start with first row\n        this.rowWidth = 0; //hold temp rowWidth of each row.\n        this.line = 0; //y position of images to position\n        this.called = 0;\n\n        //positions rows of images rescales row ti make it fit first row\n        this.draw = function() {\n\n            var x = 0;\n            this.images.map(function(image){\n                image.setHeight(this.height,true);\n                image.setPosition({x:x,y:this.line});\n                var tileSourceBounds = image.getBounds();\n                x = x+tileSourceBounds.width+(this.tileMargin*this.height);\n            }, this);\n\n\n            this.ready = false;\n            this.line += this.height+this.tileMargin;\n            this.images = [];\n            //this.resizePercentage = 1;\n            this.rowWidth = 0;\n        };\n\n        this.addTileSource = function (tileSource) {\n            this.called++;\n            if(this.isReady()){\n                throw 'Can\\'t add tilesource to ready row!';\n            }\n\n            //set height of tile to 1, image will change keeping right ratio, images are of equal height in each row\n            tileSource.setHeight(1, true);\n\n            var tileSourceBounds = tileSource.getBounds();\n            tileSource.ratio = Math.round((tileSourceBounds.width/tileSourceBounds.height)*100) / 100;\n            tileSource.width = tileSourceBounds.width;\n\n            this.images.push(tileSource);\n\n            this.rowWidth = this.rowWidth+(tileSource.width)+this.tileMargin;\n\n            //first row based on number of images, based on this the other rows will match it width\n            if(this.firstRow === true && this.images.length === this.columns) {\n                this.totalWidth = this.rowWidth;\n                this.firstRow = false;\n                this.ready = true;\n                this.draw();\n                return;\n            }\n\n            if(this.firstRow === false && this.rowWidth >= this.totalWidth ){\n                var resizePercentage = this.totalWidth/this.rowWidth; //1200/1300 = 0.92\n                this.height = resizePercentage;\n                this.ready = true;\n                this.draw();\n            }\n        };\n\n        this.isReady = function() {\n            return this.ready;\n        };\n    };\n\n})(OpenSeadragon);"],"sourceRoot":"/source/"}